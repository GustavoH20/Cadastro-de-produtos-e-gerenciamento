<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listagem de Produtos</title>
</head>
<body>
<header>
    <h2>Controle de Estoque - A Trelosa</h2>
    <table id="productTable" border="1">
        <thead>
        <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>Pre√ßo</th>
        </tr>
        </thead>
        <tbody>

        </tbody>
    </table>

    <div id="erroMensagem" style="color: red; display: none;">
    </div>
    <div id="totalProdutos"> Total de Produtos: 0</div>

    <script>
        function listarProdutos(){
        fetch('http://localhost:8080/produtos')
        .then(reponse => {
        if(!reponse.ok){
            throw new Error("Erro na rede: " + reponse.statusText);
        }
        return reponse.json();
        })
        .then(data =>{
        const tableBody = document.getElementById('productTable').getElementsByTagName('tbody')[0];
        let totalProdutos = 0;
        data.forEach(produto => {
        const row = tableBody.insertRow();
        const cellId = row.insertCell(0);
        const cellNome = row.insertCell(1);
        const cellPreco = row.insertCell(2);
        cellId.textContent = produto.id;
        cellNome.textContent = produto.nome;
        cellPreco.textContent = produto.preco.toFixed(2);
        totalProdutos++;
        });
        document.getElementById('totalProdutos').textContent = 'Total de Produtos: ' + totalProdutos;
        })
        .catch(error => {
        console.error('Erro ao buscar produtos:', error);
        document.getElementById('errorMensagem').style.display = 'block';
        });
        }
        document.addEventListener('DOMContentLoaded', listarProdutos);
    </script>
</header>
</body>
</html>
